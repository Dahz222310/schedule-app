<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <title>Просмотр пожеланий (менеджер)</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .container { max-width: 800px; margin: 0 auto; }
        .form { margin: 20px 0; padding: 15px; border: 1px solid #ccc; border-radius: 5px; }
        .form h2 { margin-top: 0; }
        input, button { margin: 5px 0; }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        th, td {
            border: 1px solid #ccc;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f0f0f0;
        }
        .button-container {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Просмотр пожеланий (менеджер)</h1>

        <div class="form">
            <h2>Все временные пожелания сотрудников</h2>
            <div class="button-container">
                <button onclick="showAllPreferences()">Показать все пожелания</button>
                <button onclick="clearAllPreferences()">Очистить все пожелания</button>
            </div>
            <table id="manager_table">
                <thead>
                    <tr>
                        <th>Сотрудник</th>
                        <th>Пожелания (дни)</th>
                    </tr>
                </thead>
                <tbody id="manager_view"></tbody>
            </table>
        </div>
    </div>

    <script>
        const month = 1; // февраль

        function showAllPreferences() {
            const managerView = document.getElementById("manager_view");
            managerView.innerHTML = "";

            const keys = Object.keys(localStorage);
            let found = false;

            keys.forEach(key => {
                if (key.startsWith(`schedule_prefs_${month}_`)) {
                    const savedPrefs = localStorage.getItem(key);
                    const prefs = JSON.parse(savedPrefs);

                    const row = document.createElement("tr");

                    const nameCell = document.createElement("td");
                    nameCell.textContent = prefs.name;

                    const daysCell = document.createElement("td");
                    daysCell.textContent = prefs.workDays.length > 0 ? prefs.workDays.join(", ") : "Нет пожеланий";

                    row.appendChild(nameCell);
                    row.appendChild(daysCell);
                    managerView.appendChild(row);

                    found = true;
                }
            });

            if (!found) {
                const row = document.createElement("tr");
                const cell = document.createElement("td");
                cell.colSpan = 2;
                cell.textContent = "Пока нет пожеланий.";
                row.appendChild(cell);
                managerView.appendChild(row);
            }
        }

        function clearAllPreferences() {
            if (confirm("Вы уверены, что хотите очистить все пожелания?")) {
                const keys = Object.keys(localStorage);

                keys.forEach(key => {
                    if (key.startsWith(`schedule_prefs_${month}_`)) {
                        localStorage.removeItem(key);
                    }
                });

                document.getElementById("manager_view").innerHTML = "";
                const row = document.createElement("tr");
                const cell = document.createElement("td");
                cell.colSpan = 2;
                cell.textContent = "Все пожелания очищены.";
                row.appendChild(cell);
                document.getElementById("manager_view").appendChild(row);
            }
        }

        window.onload = () => {
            showAllPreferences();
        };
    </script>
</body>
</html>
